#!/usr/bin/env python3

from docx import Document
from docx.enum.text import WD_ALIGN_PARAGRAPH
from docx.enum.text import WD_LINE_SPACING
import oms


outfile = "ms.docx"
db      = "../example"

doc = Document()

oms.read.set_manuscriptdir(db)
oms.read.read()

p = doc.add_paragraph("{}\n{}\n{}, {} {}\n{}\n{}\n".format(
                        oms.read.author["name"],
                        oms.read.author["streetAddress"],
                        oms.read.author["addressLocality"], 
                        oms.read.author["addressRegion"], 
                        oms.read.author["postalCode"],
                        oms.read.author["phone"],
                        oms.read.author["email"]))

pf = p.paragraph_format
pf.alignment = WD_ALIGN_PARAGRAPH.RIGHT
pf.alignment = WD_LINE_SPACING.SINGLE

doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()
doc.add_paragraph()

p = doc.add_paragraph("{}\nby {}".format(
                        oms.read.manuscript["title"], 
                        oms.read.author["name"]))
pf = p.paragraph_format
pf.alignment = WD_ALIGN_PARAGRAPH.CENTER
pf.alignment = WD_LINE_SPACING.SINGLE

doc.save(outfile)


